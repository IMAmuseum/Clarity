<?php


function datasource_management_field_schema($field) {

  if ($field['type'] != 'dashboard_datasource_reference') return;

  return array(
    'columns' => array(
      'dsid' => array(
        'type' => 'int',
        'unsigned' => TRUE,
        'default'  => 0,
      ),
    ),    
  );

}


function datasource_management_schema() {

  $schema['dashboard_datasource'] = array(
    'description' => 'Stores the dashboard datasource index',
    'fields' => array(
      'dsid' => array(
        'type' => 'serial',
        'not null' => true,
        'unsigned' => true,
        'description' => 'Datasource ID'
      ),
      'module' => array(
        'type' => 'varchar',
        'length' => 48,
        'not null' => true,
        'description' => 'The module responsible for this datasource'
      ),          
      'name' => array(
        'type' => 'varchar',
        'length' => 48,
        'not null' => true,
        'description' => 'The machine-readable datasource name'        
      ), 
      'label' => array(
        'type' => 'varchar',
        'length' => 255,
        'not null' => true,
        'description' => 'The human-readable datasource name'        
      ),
      'data' => array(
        'type' => 'text',
        'not null' => FALSE,
        'size' => 'big',
        'serialize' => TRUE,
        'description' => 'A serialized array of additional data related to this datasource',
        'merge' => TRUE,        
      )   
    ),
    'primary key' => array('dsid'),
    'unique keys' => array(
      'name' => array('module','name')
    )
  );
  
  return $schema;
  
}